<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>메인 페이지</title>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js"></script>

</head>
<body>
    <h2>메인 페이지</h2>

    <!-- 로그인 여부 확인 -->
    <div id="auth-button">
        <!-- 로그인 상태에 따라 버튼 표시 -->
        <a href="/signup"><button id="signup-btn">회원가입</button></a>
        <a href="/google/login"><button id="login-btn">Google로 로그인</button></a>
        <button id="logout-btn" onclick="logout()">로그아웃</button>
    </div>

    <!-- 게시판으로 이동 버튼 -->
    <div>
        <a href="/board"><button id="board-btn">게시판</button></a>
    </div>

    <script>
        // URL에서 인가 코드 추출
        const params = new URLSearchParams(window.location.search);
        const code = params.get("code");

        if (code) {
                fetch(`/login/oauth2/google/?code=${code}`)
                    .catch(error => {
                        console.error("Login Error:", error);
                    });
            }
        
        const accessToken = Cookies.get('access_token');
        // accessToken이 있으면 로그인된 사용자라는 것, 로그아웃 버튼 표시
        if (accessToken) {
            document.getElementById("signup-btn").style.display = "none";
            document.getElementById("login-btn").style.display = "none";
            document.getElementById("logout-btn").style.display = "inline-block";
        } else {
            // 없을 경우 로그인이 필요한 사용자, 로그인 버튼 표시
            document.getElementById("signup-btn").style.display = "inline-block";
            document.getElementById("login-btn").style.display = "inline-block";
            document.getElementById("logout-btn").style.display = "none";
        }

        // 로그아웃시 저장된 쿠키 삭제
        function logout() {
            Cookies.remove('access_token');
            Cookies.remove('refresh_token');
            alert("로그아웃되었습니다.");
            location.reload();
        }

</script>
</body>
</html>
